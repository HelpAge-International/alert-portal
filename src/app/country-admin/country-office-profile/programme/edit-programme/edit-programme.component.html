<app-country-admin-header></app-country-admin-header>
<app-country-admin-menu></app-country-admin-menu>

<app-status-alert [message]="alertMessage?.message" [success]="alertMessage?.type === alertMessageType.Success" [show] = "alertMessage"></app-status-alert>

<div class="Page-top__wrap--w_sub_header--no-paddng">
    <div class="Full-page__wrap--inner">
        <div class="Back--button Spaced-above">
            <a href="javascript:void(0)" (click)="backButton()">{{"COUNTRY_ADMIN.PROFILE.PROGRAMME.EDIT_PROGRAMME.BACK_BUTTON" | translate}}</a>
        </div>
        <app-country-office-profile-menu></app-country-office-profile-menu>
        <div class="Header-title__wrap Spaced row">
            <h2 class="col-sm-2">{{"COUNTRY_ADMIN.PROFILE.PROGRAMME.EDIT_PROGRAMME.TITLE" | translate}}</h2>
        </div>

        <div class="Spaced row">
            <h6 class="col-sm-2 text-bold">{{"COUNTRY_ADMIN.PROFILE.PROGRAMME.COMMON.SECTOR_EXPERTISE" | translate}}</h6>
            <a href="javascript:void(0)" data-toggle="modal" data-target="#sectorSelection" class="col-sm-0" (click)="TmpSectorExpertise = []">{{"GLOBAL.EDIT" | translate}}</a>
        </div>

        <br>
        <div class="row-sm-12" *ngIf="sectorExpertise && sectorExpertise.length > 0">
            <div class="row">
                <div class="Item__selectable Icon__selectable col-sm-0" *ngFor="let s of sectorExpertise">
                     <div onClick="$(this).toggleClass('Selected');"  class="{{ResponsePlanSectors[s.key] | translate | lowercase}}"></div>
                    <label>{{ResponsePlanSectors[s.key] | translate}}</label>
                </div>
            </div>
        </div>

        <div class="row-sm-12" *ngIf="!sectorExpertise || !sectorExpertise.length">
            <p class="text-gray-v-light">{{"COUNTRY_ADMIN.PROFILE.PROGRAMME.COMMON.NO_SECTOR_SELECTED" | translate}}</p>
        </div>
        <div class="Line-row margin-left"></div>

        <h3 class="row-sm-12 Spaced-above">{{"COUNTRY_ADMIN.PROFILE.PROGRAMME.COMMON.4WMAPPING" | translate}}</h3>
        <br>
        <div class="row">
            <div class="col-sm-2"><strong>{{"COUNTRY_ADMIN.PROFILE.PROGRAMME.COMMON.TABLE_SECTOR" | translate}}</strong></div>
            <div class="col-sm-2"><strong>{{"COUNTRY_ADMIN.PROFILE.PROGRAMME.COMMON.TABLE_WHAT" | translate}}</strong></div>
            <div class="col-sm-2"><strong>{{"COUNTRY_ADMIN.PROFILE.PROGRAMME.COMMON.TABLE_WHERE" | translate}}</strong></div>
            <div class="col-sm-2"><strong>{{"COUNTRY_ADMIN.PROFILE.PROGRAMME.COMMON.TABLE_TO_WHO" | translate}}</strong></div>
            <div class="col-sm-2"><strong>{{"COUNTRY_ADMIN.PROFILE.PROGRAMME.COMMON.TABLE_WHEN" | translate}}</strong></div>
        </div>
        <div class="Line-row margin-left"></div>
        <div *ngFor="let m of mapping">
            <div  class="row">
                <div class="col-sm-2"><p><img src="assets/images/icons/{{ResponsePlanSectors[m.sector] | translate | lowercase}}.svg" alt="{{ResponsePlanSectors[m.sector] | translate}}">{{ResponsePlanSectors[m.sector] | translate}}</p></div> <!--Sector-->
                <div class="col-sm-2"><p>{{m.what ? m.what : ''}}</p></div> <!--What-->
                <div class="col-sm-2"><p>{{m.where ? m.where : ''}}</p></div> <!--Where-->
                <div class="col-sm-2"><p>{{m.toWho ? m.toWho : ''}}</p></div> <!--To Who-->
                <div class="col-sm-2"><p>{{m.when | date:"dd/MM/yyyy"}}</p></div> <!--When-->
                <div class="col-sm-1">
                    <button [routerLink]="['/country-admin/country-office-profile/mapping-programme-add-edit/', m.key]" class="btn btn-outline-primary text-uppercase">edit</button>
                </div> 
            </div>
        </div>

        <div class="row-sm-12"><p class="text-gray-v-light" *ngIf="!mapping && !mapping.length">Use the edit programme button to enter your 4W mapping</p></div>
        <div class="Line-row margin-left"></div>

        <!-- Modal Selection selector   -->

        <div class="modal fade" id="sectorSelection" tabindex="-1" role="dialog" aria-labelledby="sectorSelection" aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h6 class="modal-title" class="Spaced-above">{{"COUNTRY_ADMIN.PROFILE.PROGRAMME.EDIT_PROGRAMME.MODAL_EDIT_SECTOR_TITLE" | translate}}</h6>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>

                    <div class="row Centered Spaced-above">
                        <div *ngFor="let sector of ResponsePlanSectorsList; let key = index;">
                            <div class="Item__selectable Icon__selectable col-sm-0" *ngIf="key < 4">
                             <div onClick="$(this).toggleClass('Selected');"  (click)="selectedSectors($event, sector)" [ngClass]="setSelectorClass(sector)" class="{{ResponsePlanSectors[sector] | translate | lowercase}}"></div>
                                <label>{{ResponsePlanSectors[sector] | translate}}</label>
                            </div>
                        </div>
                    </div>

                    <div class="row Centered">
                        <div *ngFor="let sector of ResponsePlanSectorsList; let key = index;">
                            <div class="Item__selectable Icon__selectable col-sm-0" *ngIf="key > 3 && key < 8">
                                <div onClick="$(this).toggleClass('Selected');"  (click)="selectedSectors($event, sector)" [ngClass]="setSelectorClass(sector)" class="{{ResponsePlanSectors[sector] | translate | lowercase}}"></div>
                                <label>{{ResponsePlanSectors[sector] | translate}}</label>
                            </div>
                        </div>
                    </div>

                    <div class="row Right-aligned Spaced col-sm-12">
                        <a href="#" data-dismiss="modal" class="col-sm-9 margin-top-one">Cancel</a>
                        <button href="#" data-dismiss="modal" class="btn btn-primary col-sm-3 text-uppercase" (click)="saveSectors()">{{"GLOBAL.SAVE" | translate}}
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <button [routerLink]="['/country-admin/country-office-profile/mapping-programme-add-edit/']" data-toggle="modal" class="btn btn-outline-primary text-uppercase">{{"GLOBAL.ADD" | translate}}</button>
        </div>
    </div>
</div>


